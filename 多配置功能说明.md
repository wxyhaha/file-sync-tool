# 文件同步工具 - 多配置功能使用说明

## 功能概述

文件同步工具现在支持保存和管理多个配置，用户可以为不同的同步任务创建独立的配置，并可以方便地在它们之间切换。

## 主要特性

### 1. 多配置管理
- 支持创建、保存、加载和删除多个配置
- 每个配置包含完整的同步设置（源路径、目标路径、同步模式、过滤规则）
- 配置以JSON格式存储，便于备份和迁移

### 2. 配置操作
- **加载配置**: 从下拉列表选择并加载已保存的配置
- **保存配置**: 将当前设置保存到选中的配置名
- **另存为**: 将当前设置保存为新的配置
- **删除配置**: 删除不需要的配置（至少保留一个配置）

### 3. 兼容性
- 自动从旧版本的单配置文件迁移
- 保持向后兼容性

## 界面说明

### 配置管理区域
在主界面中新增了"配置管理"区域，包含以下控件：

1. **配置选择下拉框**: 显示所有已保存的配置名称
2. **加载配置按钮**: 加载选中的配置到当前界面
3. **保存配置按钮**: 保存当前设置到选中的配置
4. **另存为按钮**: 将当前设置保存为新配置
5. **删除配置按钮**: 删除选中的配置

## 使用方法

### 创建新配置

1. 在界面中设置源路径、目标路径、同步模式和过滤规则
2. 点击"另存为"按钮
3. 在弹出的对话框中输入新配置的名称
4. 点击确定保存

### 加载已有配置

1. 从配置选择下拉框中选择要加载的配置
2. 点击"加载配置"按钮，或直接从下拉框选择（自动加载）
3. 界面将显示该配置的所有设置

### 修改配置

1. 加载要修改的配置
2. 在界面中修改相应的设置
3. 点击"保存配置"按钮保存修改

### 删除配置

1. 从配置选择下拉框中选择要删除的配置
2. 点击"删除配置"按钮
3. 在确认对话框中点击"是"确认删除

## 配置文件格式

### 多配置文件 (sync_configs.json)
```json
{
  "工作配置": {
    "source_path": "C:/Work/Documents",
    "target_path": "D:/Backup/Work",
    "sync_mode": "双向同步",
    "filter_rules": "*.tmp,*.log"
  },
  "个人配置": {
    "source_path": "C:/Users/Personal",
    "target_path": "E:/Backup/Personal",
    "sync_mode": "单向同步",
    "filter_rules": "*.cache"
  }
}
```

### 配置字段说明
- `source_path`: 源文件夹路径
- `target_path`: 目标文件夹路径
- `sync_mode`: 同步模式（"单向同步" 或 "双向同步"）
- `filter_rules`: 过滤规则，多个规则用逗号分隔

## 使用场景示例

### 场景1: 工作文档同步
```
配置名称: 工作配置
源路径: C:/Work/Documents
目标路径: D:/Backup/Work
同步模式: 双向同步
过滤规则: *.tmp,*.log,~$*
```

### 场景2: 个人照片备份
```
配置名称: 照片备份
源路径: C:/Users/用户名/Pictures
目标路径: E:/Backup/Photos
同步模式: 单向同步
过滤规则: *.db,Thumbs.db
```

### 场景3: 项目代码同步
```
配置名称: 项目同步
源路径: C:/Projects/MyProject
目标路径: D:/Backup/Projects/MyProject
同步模式: 单向同步
过滤规则: node_modules,*.pyc,__pycache__,.git
```

## 注意事项

1. **配置名称唯一性**: 每个配置必须有唯一的名称
2. **最少配置数量**: 系统至少保留一个配置，不能删除最后一个配置
3. **配置文件备份**: 建议定期备份配置文件 `sync_configs.json`
4. **路径有效性**: 保存配置前请确保路径设置正确
5. **权限要求**: 确保程序对配置文件所在目录有读写权限

## 故障排除

### 配置加载失败
- 检查配置文件 `sync_configs.json` 是否存在
- 验证JSON格式是否正确
- 确认文件编码为UTF-8

### 配置保存失败
- 检查程序是否有写入权限
- 确认磁盘空间充足
- 验证配置名称是否包含非法字符

### 配置丢失
- 检查是否存在 `sync_config.json`（旧版本单配置文件）
- 程序会自动从旧配置文件迁移到新格式

## 技术实现

### 配置存储
- 配置存储在 `sync_configs.json` 文件中
- 使用JSON格式，支持UTF-8编码
- 自动创建备份和恢复机制

### 兼容性处理
- 自动检测并迁移旧版本配置文件
- 保持与旧版本的向后兼容性
- 支持配置文件格式升级

### 错误处理
- 完善的异常处理机制
- 用户友好的错误提示
- 自动恢复和容错功能

---

**版本**: 2.0.0  
**更新日期**: 2024年12月  
**作者**: 文件同步工具开发团队